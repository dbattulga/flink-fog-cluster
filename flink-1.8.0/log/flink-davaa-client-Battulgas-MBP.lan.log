2019-05-24 17:27:06,160 INFO  org.apache.flink.client.cli.CliFrontend                       - --------------------------------------------------------------------------------
2019-05-24 17:27:06,162 INFO  org.apache.flink.client.cli.CliFrontend                       -  Starting Command Line Client (Version: 1.8.0, Rev:4caec0d, Date:03.04.2019 @ 13:25:54 PDT)
2019-05-24 17:27:06,162 INFO  org.apache.flink.client.cli.CliFrontend                       -  OS current user: davaa
2019-05-24 17:27:06,162 INFO  org.apache.flink.client.cli.CliFrontend                       -  Current Hadoop/Kerberos user: <no hadoop dependency found>
2019-05-24 17:27:06,162 INFO  org.apache.flink.client.cli.CliFrontend                       -  JVM: Java HotSpot(TM) 64-Bit Server VM - Oracle Corporation - 1.8/25.201-b09
2019-05-24 17:27:06,163 INFO  org.apache.flink.client.cli.CliFrontend                       -  Maximum heap size: 3641 MiBytes
2019-05-24 17:27:06,163 INFO  org.apache.flink.client.cli.CliFrontend                       -  JAVA_HOME: (not set)
2019-05-24 17:27:06,163 INFO  org.apache.flink.client.cli.CliFrontend                       -  No Hadoop Dependency available
2019-05-24 17:27:06,163 INFO  org.apache.flink.client.cli.CliFrontend                       -  JVM Options:
2019-05-24 17:27:06,163 INFO  org.apache.flink.client.cli.CliFrontend                       -     -Dlog.file=/Users/davaa/flink-1.8.0/log/flink-davaa-client-Battulgas-MBP.lan.log
2019-05-24 17:27:06,163 INFO  org.apache.flink.client.cli.CliFrontend                       -     -Dlog4j.configuration=file:/Users/davaa/flink-1.8.0/conf/log4j-cli.properties
2019-05-24 17:27:06,163 INFO  org.apache.flink.client.cli.CliFrontend                       -     -Dlogback.configurationFile=file:/Users/davaa/flink-1.8.0/conf/logback.xml
2019-05-24 17:27:06,163 INFO  org.apache.flink.client.cli.CliFrontend                       -  Program Arguments:
2019-05-24 17:27:06,163 INFO  org.apache.flink.client.cli.CliFrontend                       -     run
2019-05-24 17:27:06,163 INFO  org.apache.flink.client.cli.CliFrontend                       -     -c
2019-05-24 17:27:06,164 INFO  org.apache.flink.client.cli.CliFrontend                       -     flinkmetrics.RideCount
2019-05-24 17:27:06,164 INFO  org.apache.flink.client.cli.CliFrontend                       -     /Users/davaa/flink-metrics/target/flink-metrics-0.1.jar
2019-05-24 17:27:06,164 INFO  org.apache.flink.client.cli.CliFrontend                       -  Classpath: /Users/davaa/flink-1.8.0/lib/flink-metrics-prometheus-1.8.0.jar:/Users/davaa/flink-1.8.0/lib/log4j-1.2.17.jar:/Users/davaa/flink-1.8.0/lib/slf4j-log4j12-1.7.15.jar:/Users/davaa/flink-1.8.0/lib/flink-dist_2.11-1.8.0.jar:::
2019-05-24 17:27:06,164 INFO  org.apache.flink.client.cli.CliFrontend                       - --------------------------------------------------------------------------------
2019-05-24 17:27:06,171 INFO  org.apache.flink.configuration.GlobalConfiguration            - Loading configuration property: jobmanager.rpc.address, localhost
2019-05-24 17:27:06,172 INFO  org.apache.flink.configuration.GlobalConfiguration            - Loading configuration property: jobmanager.rpc.port, 6123
2019-05-24 17:27:06,172 INFO  org.apache.flink.configuration.GlobalConfiguration            - Loading configuration property: jobmanager.heap.size, 1024m
2019-05-24 17:27:06,172 INFO  org.apache.flink.configuration.GlobalConfiguration            - Loading configuration property: taskmanager.heap.size, 1024m
2019-05-24 17:27:06,172 INFO  org.apache.flink.configuration.GlobalConfiguration            - Loading configuration property: taskmanager.numberOfTaskSlots, 1
2019-05-24 17:27:06,172 INFO  org.apache.flink.configuration.GlobalConfiguration            - Loading configuration property: parallelism.default, 1
2019-05-24 17:27:06,173 INFO  org.apache.flink.configuration.GlobalConfiguration            - Loading configuration property: rest.port, 8081
2019-05-24 17:27:06,174 INFO  org.apache.flink.configuration.GlobalConfiguration            - Loading configuration property: metrics.reporters, prom
2019-05-24 17:27:06,174 INFO  org.apache.flink.configuration.GlobalConfiguration            - Loading configuration property: metrics.reporter.prom.class, org.apache.flink.metrics.prometheus.PrometheusReporter
2019-05-24 17:27:06,174 INFO  org.apache.flink.configuration.GlobalConfiguration            - Loading configuration property: metrics.reporter.prom.port, 9250-9260
2019-05-24 17:27:06,179 WARN  org.apache.flink.client.cli.CliFrontend                       - Could not load CLI class org.apache.flink.yarn.cli.FlinkYarnSessionCli.
java.lang.NoClassDefFoundError: org/apache/hadoop/yarn/exceptions/YarnException
	at java.lang.Class.forName0(Native Method)
	at java.lang.Class.forName(Class.java:264)
	at org.apache.flink.client.cli.CliFrontend.loadCustomCommandLine(CliFrontend.java:1230)
	at org.apache.flink.client.cli.CliFrontend.loadCustomCommandLines(CliFrontend.java:1190)
	at org.apache.flink.client.cli.CliFrontend.main(CliFrontend.java:1115)
Caused by: java.lang.ClassNotFoundException: org.apache.hadoop.yarn.exceptions.YarnException
	at java.net.URLClassLoader.findClass(URLClassLoader.java:382)
	at java.lang.ClassLoader.loadClass(ClassLoader.java:424)
	at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:349)
	at java.lang.ClassLoader.loadClass(ClassLoader.java:357)
	... 5 more
2019-05-24 17:27:06,193 INFO  org.apache.flink.core.fs.FileSystem                           - Hadoop is not in the classpath/dependencies. The extended set of supported File Systems via Hadoop is not available.
2019-05-24 17:27:06,579 INFO  org.apache.flink.runtime.security.modules.HadoopModuleFactory  - Cannot create Hadoop Security Module because Hadoop cannot be found in the Classpath.
2019-05-24 17:27:06,614 INFO  org.apache.flink.runtime.security.SecurityUtils               - Cannot install HadoopSecurityContext because Hadoop cannot be found in the Classpath.
2019-05-24 17:27:06,615 INFO  org.apache.flink.client.cli.CliFrontend                       - Running 'run' command.
2019-05-24 17:27:06,622 INFO  org.apache.flink.client.cli.CliFrontend                       - Building program from JAR file
2019-05-24 17:27:06,762 INFO  org.apache.flink.configuration.Configuration                  - Config uses fallback configuration key 'jobmanager.rpc.address' instead of key 'rest.address'
2019-05-24 17:27:07,047 INFO  org.apache.flink.runtime.rest.RestClient                      - Rest client endpoint started.
2019-05-24 17:27:07,050 INFO  org.apache.flink.client.cli.CliFrontend                       - Starting execution of program
2019-05-24 17:27:07,051 INFO  org.apache.flink.client.program.rest.RestClusterClient        - Starting program in interactive mode (detached: false)
2019-05-24 17:27:07,139 INFO  org.apache.flink.api.java.typeutils.TypeExtractor             - class org.joda.time.DateTime does not contain a getter for field iMillis
2019-05-24 17:27:07,140 INFO  org.apache.flink.api.java.typeutils.TypeExtractor             - class org.joda.time.DateTime does not contain a setter for field iMillis
2019-05-24 17:27:07,140 INFO  org.apache.flink.api.java.typeutils.TypeExtractor             - Class class org.joda.time.DateTime cannot be used as a POJO type because not all fields are valid POJO fields, and must be processed as GenericType. Please read the Flink documentation on "Data Types & Serialization" for details of the effect on performance.
2019-05-24 17:27:07,144 INFO  org.apache.flink.api.java.typeutils.TypeExtractor             - class org.joda.time.DateTime does not contain a getter for field iMillis
2019-05-24 17:27:07,145 INFO  org.apache.flink.api.java.typeutils.TypeExtractor             - class org.joda.time.DateTime does not contain a setter for field iMillis
2019-05-24 17:27:07,145 INFO  org.apache.flink.api.java.typeutils.TypeExtractor             - Class class org.joda.time.DateTime cannot be used as a POJO type because not all fields are valid POJO fields, and must be processed as GenericType. Please read the Flink documentation on "Data Types & Serialization" for details of the effect on performance.
2019-05-24 17:27:07,359 INFO  org.apache.flink.configuration.GlobalConfiguration            - Loading configuration property: jobmanager.rpc.address, localhost
2019-05-24 17:27:07,359 INFO  org.apache.flink.configuration.GlobalConfiguration            - Loading configuration property: jobmanager.rpc.port, 6123
2019-05-24 17:27:07,360 INFO  org.apache.flink.configuration.GlobalConfiguration            - Loading configuration property: jobmanager.heap.size, 1024m
2019-05-24 17:27:07,360 INFO  org.apache.flink.configuration.GlobalConfiguration            - Loading configuration property: taskmanager.heap.size, 1024m
2019-05-24 17:27:07,360 INFO  org.apache.flink.configuration.GlobalConfiguration            - Loading configuration property: taskmanager.numberOfTaskSlots, 1
2019-05-24 17:27:07,360 INFO  org.apache.flink.configuration.GlobalConfiguration            - Loading configuration property: parallelism.default, 1
2019-05-24 17:27:07,360 INFO  org.apache.flink.configuration.GlobalConfiguration            - Loading configuration property: rest.port, 8081
2019-05-24 17:27:07,360 INFO  org.apache.flink.configuration.GlobalConfiguration            - Loading configuration property: metrics.reporters, prom
2019-05-24 17:27:07,361 INFO  org.apache.flink.configuration.GlobalConfiguration            - Loading configuration property: metrics.reporter.prom.class, org.apache.flink.metrics.prometheus.PrometheusReporter
2019-05-24 17:27:07,361 INFO  org.apache.flink.configuration.GlobalConfiguration            - Loading configuration property: metrics.reporter.prom.port, 9250-9260
2019-05-24 17:27:07,363 INFO  org.apache.flink.client.program.rest.RestClusterClient        - Submitting job 0e3d19f0e1694e8e5f0ad5aab750ccb2 (detached: false).
2019-05-24 17:27:13,676 INFO  org.apache.flink.runtime.rest.RestClient                      - Shutting down rest endpoint.
2019-05-24 17:27:13,680 INFO  org.apache.flink.runtime.rest.RestClient                      - Rest endpoint shutdown complete.
2019-05-24 17:27:13,681 ERROR org.apache.flink.client.cli.CliFrontend                       - Error while running the command.
org.apache.flink.client.program.ProgramInvocationException: Job failed. (JobID: 0e3d19f0e1694e8e5f0ad5aab750ccb2)
	at org.apache.flink.client.program.rest.RestClusterClient.submitJob(RestClusterClient.java:268)
	at org.apache.flink.client.program.ClusterClient.run(ClusterClient.java:483)
	at org.apache.flink.streaming.api.environment.StreamContextEnvironment.execute(StreamContextEnvironment.java:66)
	at flinkmetrics.RideCount.main(RideCount.java:89)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.flink.client.program.PackagedProgram.callMainMethod(PackagedProgram.java:529)
	at org.apache.flink.client.program.PackagedProgram.invokeInteractiveModeForExecution(PackagedProgram.java:421)
	at org.apache.flink.client.program.ClusterClient.run(ClusterClient.java:423)
	at org.apache.flink.client.cli.CliFrontend.executeProgram(CliFrontend.java:813)
	at org.apache.flink.client.cli.CliFrontend.runProgram(CliFrontend.java:287)
	at org.apache.flink.client.cli.CliFrontend.run(CliFrontend.java:213)
	at org.apache.flink.client.cli.CliFrontend.parseParameters(CliFrontend.java:1050)
	at org.apache.flink.client.cli.CliFrontend.lambda$main$11(CliFrontend.java:1126)
	at org.apache.flink.runtime.security.NoOpSecurityContext.runSecured(NoOpSecurityContext.java:30)
	at org.apache.flink.client.cli.CliFrontend.main(CliFrontend.java:1126)
Caused by: org.apache.flink.runtime.client.JobExecutionException: Job execution failed.
	at org.apache.flink.runtime.jobmaster.JobResult.toJobExecutionResult(JobResult.java:146)
	at org.apache.flink.client.program.rest.RestClusterClient.submitJob(RestClusterClient.java:265)
	... 17 more
Caused by: java.io.FileNotFoundException: /Users/davaa/flink-metrics/source_data/nycTaxiRides.gz (No such file or directory)
	at java.io.FileInputStream.open0(Native Method)
	at java.io.FileInputStream.open(FileInputStream.java:195)
	at java.io.FileInputStream.<init>(FileInputStream.java:138)
	at java.io.FileInputStream.<init>(FileInputStream.java:93)
	at flinkmetrics.TaxiRideSource.run(TaxiRideSource.java:105)
	at org.apache.flink.streaming.api.operators.StreamSource.run(StreamSource.java:93)
	at org.apache.flink.streaming.api.operators.StreamSource.run(StreamSource.java:57)
	at org.apache.flink.streaming.runtime.tasks.SourceStreamTask.run(SourceStreamTask.java:97)
	at org.apache.flink.streaming.runtime.tasks.StreamTask.invoke(StreamTask.java:300)
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:711)
	at java.lang.Thread.run(Thread.java:748)
